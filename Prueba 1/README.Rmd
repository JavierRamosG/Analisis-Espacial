---
title: "Prueba 1 - Javier Ramos"
output: github_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```
## Carga de datos y librerías

Se cargará la data y las librerías necesarias para el posterior análisis.

```{r}
#Dataframe
df = read.table(file = "data.txt", header = TRUE)

#Librerías
library(mapproj)
library(devtools)
library(fields)
library(geoR)
library(GeoModels)
```


## Pregunta A
### Desarrollo:
```{r}
#Radio de la tierra
r = 6371

#Separar las columnas de longitud y latitud
x = df[,1]
y = df[,2]

#Se procede a realizar la proyección sinusoidal
prj_sinusoidal = mapproject(x, y, projection="sinusoidal",orientation=c(90,0,0)) 
result = r*cbind(prj_sinusoidal$x,prj_sinusoidal$y)
df2 = cbind(result, df[,3])

#Se renombran las filas y las columnas para facilitar la lectura de la tabla
colnames(df2) <- c("lon", "lat", "anom")
rownames(df2) <- 1:nrow(df2)
#df2
```

## Pregunta B
### Desarrollo:

Primero se realizará la simulación a través del modelo de Matern
```{r}
sill = 1
mean = 0
nugget = 0
smooth = 0.5
scale = 0.1

param=list(smooth=smooth,mean=mean,sill=sill,scale=scale,nugget=nugget) 
data1 <- GeoSim(coordx=df2[,1],coordy = df2[,2], corrmodel="Matern", param=param)$data
```

Luego, se procede a realizar un análisis gráfico:

```{r}
#quilt.plot(df2[,1], df2[,2], data1, xlab="", ylab="", main=paste("Matern",expression(nu),"=",smooth))
quilt.plot(df2[,1], df2[,2], data1)

hist(data1)
boxplot(data1)
```

A partir del boxplot se puede determinar que hay outliers, pero que estos son simétricos. Respecto al histograma, claramente hay un comportamiento de normalidad y respecto al gráfico de colores no se ve con tanta claridad si hay o no una dependencia. Por lo tanto, sí se puede decir que el modelo Gaussiano es adecuado.

## Pregunta C
### Desarrollo:

## Pregunta D
### Desarrollo:

## Pregunta E
### Desarrollo:

## Pregunta F
### Desarrollo:

## Pregunta G
### Desarrollo:

## Pregunta H
### Desarrollo:

## Pregunta I
### Desarrollo:
